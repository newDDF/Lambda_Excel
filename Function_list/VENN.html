VENN=LAMBDA(x,y,lg,IF(lg,FILTER(TOROW(IF(SCAN(1,x,LAMBDA(a,aaa,OR(TRIM(INDEX(aaa,COUNTA(aaa)))=TRIM(TEXTSPLIT(ARRAYTOTEXT(y),","))))),x,"")),TOROW(IF(SCAN(1,x,LAMBDA(a,aaa,OR(TRIM(INDEX(aaa,COUNTA(aaa)))=TRIM(TEXTSPLIT(ARRAYTOTEXT(y),","))))),x,""))<>""),FILTER(TOROW(IF(SCAN(1,x,LAMBDA(a,aaa,OR(TRIM(INDEX(aaa,COUNTA(aaa)))=TRIM(TEXTSPLIT(ARRAYTOTEXT(y),","))))),"",x)),TOROW(IF(SCAN(1,x,LAMBDA(a,aaa,OR(TRIM(INDEX(aaa,COUNTA(aaa)))=TRIM(TEXTSPLIT(ARRAYTOTEXT(y),","))))),"",x))<>"")))
