<!--Method1&Recommended-->
ODDS=LAMBDA(S,P,INDEX(S,FIND(1,CONCAT(FREQUENCY(RAND(),SCAN(0,P,LAMBDA(x,y,x+y)))))))

<!--Method2-->
ODDS=LAMBDA(S,P,LET(S,TOCOL(S),P,TOCOL(P),IF(SUM(P)<>1,"Error#The total probability is not equal to 1!",INDEX(REPTATOMARRAY(S,P*(1&REPT(0,MAX(LEN(P)-FIND(".",P))))*1),RANDBETWEEN(1,SUM(P*(1&REPT(0,MAX(LEN(P)-FIND(".",P))))*1))))))
REPTATOMARRAY=LAMBDA(x,y,TOCOL(TEXTSPLIT(SUBSTITUTE(TEXTJOIN("♪",,LEFT(REPT(x&"♪",y),LEN(REPT(x&"♪",y))-1))," ",""),"♪")))
